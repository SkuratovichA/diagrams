@startuml_seq
@participant app
@participant cm
@participant item
@activate app
@activate cm
@notestart User enters media info page @noteend
@notestart Check if item exists @noteend
app -> cm @actmsgstart findItem(itemId) @actmsgend
cm -> cm @actmsgstart lookup(itemId) @actmsgend
@altstart @condstart item found @condend
cm --> app @actmsgstart item @actmsgend
@else @condstart not found @condend
cm --> app @actmsgstart null @actmsgend
app -> cm @actmsgstart createItem(itemId, contentURL) @actmsgend
cm -> item @actmsgstart new(itemId, contentURL) @actmsgend
@activate item
cm --> app @actmsgstart item @actmsgend
app -> cm @actmsgstart loadMetadata() @actmsgend
@notestart Download and parse manifest, save in db @noteend
cm --> app @actmsgstart onTracksAvailable @actmsgend
cm --> app @actmsgstart onDownloadMetadata @actmsgend
@notestart See //track-selection// flow @noteend
@altend
@notestart app is ready to start downloading @noteend
app -> item @actmsgstart startDownload() @actmsgend
@enduml_seq
